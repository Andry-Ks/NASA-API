<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geomagnetic Storm</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <h1>Геомагнітні бурі за останні 30 днів</h1>
    <div id="content">
        <p>Завантаження...</p>
    </div>
    <script>
        // Функція для отримання даних про геомагнітні бурі з сервера
        async function fetchGST() {
            try {
                // Виконуємо запит до маршруту /api/gst
                const response = await fetch('/api/gst');
                const data = await response.json();

                // Функція для визначення кольору залежно від значення індексу К
                function getColorForKpIndex(kpIndex) {
                if (kpIndex < 3) return 'green';
                if (kpIndex < 5) return 'yellow';
                if (kpIndex < 8) return 'orange';
                return 'red';
                }

// Оновлюємо вміст сторінки отриманими даними
    const content = data.length > 0 ? data.map(item => {
    const kpIndex = item.allKpIndex.length > 0 ? item.allKpIndex[0].kpIndex : 'Невідомо';
    const color = kpIndex !== 'Невідомо' ? getColorForKpIndex(kpIndex) : 'gray';

    return `
        <div style="border-left: 5px solid ${color}; padding-left: 10px;">
            <h3>${item.startTime}</h3>
            <p style="color: ${color};">Індекс К: ${kpIndex}</p>
            <p>Джерело: ${item.allKpIndex.length > 0 ? item.allKpIndex[0].source : 'Невідомо'}</p>
            <p><a href="${item.link}" target="_blank">Деталі</a></p>
            <p>Індекс К вказує на рівень збурення магнітного поля Землі, вище значення означає сильнішу бурю.</p>
        </div>
    `;
    }).join('') : '<p>Немає даних за цей період.</p>';


            document.getElementById('content').innerHTML = content;
            } catch (error) {
            document.getElementById('content').innerHTML = 'Помилка при завантаженні даних';
            }
    }

        fetchGST();
    </script>
</body>
</html>
