<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geomagnetic Storm</title>
</head>
<body>
    <h1>Geomagnetic storms in the last 30 days</h1>
    <div id="content">
        <p>Loading...</p>
    </div>
    <script>
        async function fetchGST() {
            try {
                const response = await fetch('/api/gst');
                const data = await response.json();

                function getColorForKpIndex(kpIndex) {
                if (kpIndex < 3) return 'green';
                if (kpIndex < 5) return 'yellow';
                if (kpIndex < 8) return 'orange';
                return 'red';
                }

    const content = data.length > 0 ? data.map(item => {
    const kpIndex = item.allKpIndex.length > 0 ? item.allKpIndex[0].kpIndex : 'Unknown';
    const color = kpIndex !== 'Unknown' ? getColorForKpIndex(kpIndex) : 'gray';

    return `
        <div style="border-left: 5px solid ${color}; padding-left: 10px;">
            <h3>${item.startTime}</h3>
            <p style="color: ${color};">Index Ðš: ${kpIndex}</p>
            <p>Source: ${item.allKpIndex.length > 0 ? item.allKpIndex[0].source : 'Unknown'}</p>
            <p><a href="${item.link}" target="_blank">Details</a></p>
            <p>Index K indicates the level of disturbance of the Earth's magnetic field, a higher value means a stronger storm.</p>
        </div>
    `;
    }).join('') : '<p>No data for this period.</p>';
            document.getElementById('content').innerHTML = content;
            } catch (error) {
            document.getElementById('content').innerHTML = 'Error loading data';
            }
    }

        fetchGST();
    </script>

    <style>
body {
    background-color: rgb(246, 245, 245);
    padding-left: 40px;
    padding-top: 40px;
    padding-right: 40px;
    padding-bottom: 40px;
}
p {
    font-family: sans-serif;
}
 h1, h2, h3, p {
    color: rgb(22, 22, 22);
}
    </style>
</body>
</html>